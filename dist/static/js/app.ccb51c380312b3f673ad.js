webpackJsonp([1],{"+BTi":function(t,e){},0:function(t,e){},1:function(t,e){},"2rGO":function(t,e){},"9x2j":function(t,e){},DVUf:function(t,e){},G1q7:function(t,e){},JsiO:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("2rGO"),s("+BTi");var n=s("nu7/"),i=s.n(n),o=s("7+uW");document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector("html"),e=Math.min(window.innerWidth/750*100,75);t.style.fontSize=e+"px"});var r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},a=s("VU/8")({name:"App"},r,!1,null,null,null).exports,c=s("/ocq"),u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"slide-down"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:this.isTitleAndMenuShow,expression:"isTitleAndMenuShow"}],staticClass:"title-wrapper"},[e("div",{staticClass:"title-left"},[e("span",{staticClass:"icon-back icon"})]),this._v(" "),e("div",{staticClass:"title-right"},[e("div",{staticClass:"icon-wrapper"},[e("span",{staticClass:"icon-cart icon"})]),this._v(" "),e("div",{staticClass:"icon-wrapper"},[e("span",{staticClass:"icon-person icon"})]),this._v(" "),e("div",{staticClass:"icon-wrapper"},[e("span",{staticClass:"icon-more icon"})])])])])},staticRenderFns:[]};var l=s("VU/8")({name:"TitleBar",computed:{isTitleAndMenuShow:function(){return this.$store.state.isTitleAndMenuShow}}},u,!1,function(t){s("9x2j")},"data-v-318689ec",null).exports,h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"slide-right"}},[s("div",{staticClass:"content"},[t.isBookAvailable?s("div",{staticClass:"content-wrapper"},t._l(t.currentNavigation.toc,function(e,n){return s("div",{key:n,staticClass:"content-item",class:{current:e.href===t.currentHref},on:{click:function(s){t.navigateTo(e.href)}}},[s("span",{staticClass:"text"},[t._v(t._s(e.label))])])})):s("div",{staticClass:"empty"},[t._v("加载中...")])])])},staticRenderFns:[]};var d={bookConfig:{fontSizeList:[{fontSize:12},{fontSize:14},{fontSize:16},{fontSize:18},{fontSize:20},{fontSize:22},{fontSize:24}],themesList:[{name:"default",title:"默认",style:{body:{color:"#000",background:"#fff"}}},{name:"eye",title:"护眼",style:{body:{color:"#000",background:"#ceeaba"}}},{name:"night",title:"夜晚",style:{body:{color:"#fff",background:"#000"}}},{name:"classic",title:"经典",style:{body:{color:"#000",background:"rgb(241, 236, 226)"}}}]}},f={name:"MenuBar",components:{ContentView:s("VU/8")({name:"content-view",methods:{navigateTo:function(t){this.$emit("navigateTo",t)}},computed:{currentHref:function(){return this.$store.state.currentHref},isBookAvailable:function(){return this.$store.state.isBookAvailable},currentNavigation:function(){return this.$store.state.currentNavigation}}},h,!1,function(t){s("JsiO")},"data-v-604d4162",null).exports},data:function(){return{showTag:0,progress:0}},methods:{showSetting:function(t){this.showTag=t,3===this.showTag?(this.$store.commit("setSettingShow",!1),this.$store.commit("setContentShow",!0)):this.$store.commit("setSettingShow",!0),this.getProcess()},hideSetting:function(){this.$store.commit("setSettingShow",!1)},setFontSize:function(t){this.$emit("setFontSize",t)},setTheme:function(t){this.$emit("setTheme",t)},onProgressChange:function(t){this.$emit("onProgressChange",t.target.value)},onProgressInput:function(t){this.progress=t.target.value},hideContent:function(){this.$store.commit("setContentShow",!1)},navigateTo:function(t){this.$emit("navigateTo",t)},getProcess:function(){this.$emit("getProcess")}},computed:{fontSizeList:function(){return d.bookConfig.fontSizeList},themesList:function(){return d.bookConfig.themesList},currentFontSize:function(){return this.$store.state.currentFontSize},currentThemeId:function(){return this.$store.state.currentThemeId},isTitleAndMenuShow:function(){return this.$store.state.isTitleAndMenuShow},isContentShow:function(){return this.$store.state.isContentShow},isSettingShow:function(){return this.$store.state.isSettingShow},isBookAvailable:function(){return this.$store.state.isBookAvailable}},watch:{progress:{handler:function(t){this.$refs.progress.style.backgroundSize=t+"% 100%",localStorage.setItem("defaultProcess",t)}}}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"menu-bar"},[s("transition",{attrs:{name:"slide-up"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isSettingShow,expression:"isSettingShow"}],staticClass:"setting-wrapper"},[s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.showTag,expression:"showTag == 0"}],staticClass:"setting-font-size"},[s("div",{staticClass:"preview",style:{fontSize:t.fontSizeList[0].fontSize+"px"}},[t._v("A")]),t._v(" "),s("div",{staticClass:"font-wrapper"},t._l(t.fontSizeList,function(e,n){return s("div",{key:n,ref:"fontItem",refInFor:!0,staticClass:"font-size",on:{click:function(s){t.setFontSize(e.fontSize)}}},[t.currentFontSize==e.fontSize?s("div",{staticClass:"point"},[s("div",{staticClass:"small-point"})]):t._e()])})),t._v(" "),s("div",{staticClass:"preview",style:{fontSize:t.fontSizeList[t.fontSizeList.length-1].fontSize+"px"}},[t._v("A")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.showTag,expression:"showTag == 1"}],staticClass:"setting-theme"},t._l(t.themesList,function(e,n){return s("div",{key:n,staticClass:"setting-theme-item",on:{click:function(e){t.setTheme(n)}}},[s("div",{staticClass:"preview",class:{border:"#fff"===e.style.body.background},style:{background:e.style.body.background}}),t._v(" "),s("div",{staticClass:"text",class:{selected:n===t.currentThemeId}},[t._v(t._s(e.title))])])})),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2==t.showTag,expression:"showTag == 2"}],staticClass:"setting-progress"},[s("div",{staticClass:"progress-wrapper"},[s("input",{ref:"progress",staticClass:"progress",attrs:{type:"range",max:"100",min:"0",step:"0.1",disabled:!t.isBookAvailable},domProps:{value:t.progress},on:{change:t.onProgressChange,input:t.onProgressInput}})]),t._v(" "),s("div",{staticClass:"text-wrapper"},[s("span",[t._v(t._s(t.isBookAvailable?t.progress+"%":"加载中..."))])])])])]),t._v(" "),s("transition",{attrs:{name:"slide-up"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isTitleAndMenuShow,expression:"isTitleAndMenuShow"}],staticClass:"menu-wrapper",class:{"hide-box-shadow":t.isSettingShow||!t.isTitleAndMenuShow}},[s("div",{staticClass:"icon-wrapper"},[s("span",{staticClass:"icon-menu icon",on:{click:function(e){t.showSetting(3)}}})]),t._v(" "),s("div",{staticClass:"icon-wrapper"},[s("span",{staticClass:"icon-progress icon",on:{click:function(e){t.showSetting(2)}}})]),t._v(" "),s("div",{staticClass:"icon-wrapper"},[s("span",{staticClass:"icon-bright icon",on:{click:function(e){t.showSetting(1)}}})]),t._v(" "),s("div",{staticClass:"icon-wrapper"},[s("span",{staticClass:"icon-a icon",on:{click:function(e){t.showSetting(0)}}},[t._v("A")])])])]),t._v(" "),t.isContentShow?s("content-view",{on:{navigateTo:t.navigateTo}}):t._e(),t._v(" "),s("transition",{attrs:{name:"fade"}},[t.isContentShow?s("div",{staticClass:"content-mask",on:{click:t.hideContent}}):t._e()])],1)},staticRenderFns:[]};var m=s("VU/8")(f,v,!1,function(t){s("l/L2")},"data-v-5230c99e",null).exports,g=s("VXRH"),p={components:{TitleBar:l,MenuBar:m},data:function(){return{}},methods:{prevPage:function(){var t=this;this.rendition&&this.rendition.prev().then(function(){t.getProcess()})},nextPage:function(){var t=this;this.rendition&&this.rendition.next().then(function(){t.getProcess()})},showEpub:function(){var t=this;this.$store.state.currentPath&&(this.book=new g.a(this.$store.state.currentPath),this.rendition=this.book.renderTo("read",{width:window.innerWidth,height:window.innerHeight}),this.$store.state.currentProcess>0?this.loadingInstance=i.a.service({text:"进度读取中"}):this.rendition.display(),this.themes=this.rendition.themes,this.hooks=this.rendition.hooks,this.setFontSize(this.$store.state.currentFontSize),this.registerThemes(),this.setTheme(this.$store.state.currentThemeId),this.book.ready.then(function(){return t.$store.commit("setCurrentNavigation",t.book.navigation),t.book.locations.generate()}).then(function(){if(t.locations=t.book.locations,t.$store.commit("setBookAvailable",!0),t.$store.state.currentProcess>0){var e=t.locations.cfiFromPercentage(t.$store.state.currentProcess/100);t.rendition.display(e),t.loadingInstance.close()}}))},toggleTitleAndMenu:function(){this.$store.commit("setTitleAndMenuShow",!this.$store.state.isTitleAndMenuShow),this.$store.state.isTitleAndMenuShow||this.$refs.MenuBar.hideSetting()},setFontSize:function(t){this.$store.commit("setCurrentFontSize",t),this.themes&&this.themes.fontSize(t+"px")},registerThemes:function(){var t=this;d.bookConfig.themesList.forEach(function(e){t.themes.register(e.name,e.style)})},setTheme:function(t){this.$store.commit("setCurrentThemeId",t),this.themes&&this.themes.select(d.bookConfig.themesList[t].name)},onProgressChange:function(t){var e=t/100,s=e>0?this.locations.cfiFromPercentage(e):0;this.rendition.display(s)},navigateTo:function(t){this.rendition.display(t),this.hideTitleAndMenu(),this.getProcess()},hideTitleAndMenu:function(){this.$store.commit("setTitleAndMenuShow",!1),this.$refs.MenuBar.hideSetting(),this.$refs.MenuBar.hideContent()},getProcess:function(){if(this.$store.state.isBookAvailable){var t=this.rendition.currentLocation(),e=this.locations.percentageFromCfi(t.start.cfi);this.$refs.MenuBar.progress=Math.round(1e3*e)/10,this.$store.commit("setCurrentHref",t.start.href)}}},computed:{},mounted:function(){localStorage.getItem("currentThemeId")&&this.$store.commit("setCurrentThemeId",Number(localStorage.getItem("currentThemeId"))),localStorage.getItem("currentFontSize")&&this.$store.commit("setCurrentFontSize",Number(localStorage.getItem("currentFontSize"))),localStorage.getItem("currentProcess")&&this.$store.commit("setCurrentProcess",localStorage.getItem("currentProcess")),this.showEpub()},created:function(){var t=this;document.onkeyup=function(e){var s=e.keyCode;37===s&&t.prevPage(),39===s&&t.nextPage()}}},w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"eBook"},[s("title-bar"),t._v(" "),s("div",{ref:"Reader",staticClass:"reader-wrapper"},[s("div",{attrs:{id:"read"}}),t._v(" "),s("div",{directives:[{name:"touch",rawName:"v-touch:left",value:t.nextPage,expression:"nextPage",arg:"left"},{name:"touch",rawName:"v-touch:right",value:t.prevPage,expression:"prevPage",arg:"right"}],staticClass:"mask"},[s("div",{staticClass:"mask-left",on:{click:t.prevPage}}),t._v(" "),s("div",{staticClass:"mask-center",on:{click:t.toggleTitleAndMenu}}),t._v(" "),s("div",{staticClass:"mask-right",on:{click:t.nextPage}})])]),t._v(" "),s("menu-bar",{ref:"MenuBar",on:{setFontSize:t.setFontSize,onProgressChange:t.onProgressChange,navigateTo:t.navigateTo,getProcess:t.getProcess}})],1)},staticRenderFns:[]};var S=s("VU/8")(p,w,!1,function(t){s("m4Hp")},"data-v-ebdbd502",null).exports,C={name:"bookshelf",data:function(){return{}},methods:{addBook:function(t){var e=t.target.files[0],s=e.name.replace(/(.*\/)*([^.]+).*/gi,"$2");t.target.value="",console.log(s);var n=this,i=new FileReader;i.onload=function(t){n.$store.commit("setCurrentPath","./static/看见.epub"),n.$router.push({name:"EBook"})},i.readAsArrayBuffer(e)}}},k={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"bookshelf"},[e("div",{staticClass:"title-wrapper"},[e("div",{staticClass:"title-text"},[this._v("缓存图书")]),this._v(" "),e("div",{staticClass:"title-button"},[e("div",{staticClass:"button-text"},[this._v("添加本地图书")]),this._v(" "),e("input",{staticClass:"addBook",attrs:{type:"file",accept:".epub"},on:{change:this.addBook}})])]),this._v(" "),this._m(0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"bookshelf-wrapper"},[e("div",{staticClass:"book"},[e("div",{staticClass:"book-cover"},[e("img",{attrs:{src:"",alt:""}})]),this._v(" "),e("div",{staticClass:"book-info"},[e("div",{staticClass:"book-name"}),this._v(" "),e("div",{staticClass:"book-read"})])])])}]};var b=s("VU/8")(C,k,!1,function(t){s("DVUf")},"data-v-3496fd1d",null).exports;o.default.use(c.a);var T=new c.a({routes:[{path:"/",name:"/",redirect:"/Bookshelf"},{path:"/EBook",name:"EBook",component:S},{path:"/Bookshelf",name:"Bookshelf",component:b,meta:{title:"书架"}}]}),_=s("NYxO");o.default.use(_.a);var $={setCurrentThemeId:function(t,e){t.currentThemeId=e,localStorage.setItem("currentThemeId",e)},setCurrentFontSize:function(t,e){t.currentFontSize=e,localStorage.setItem("currentFontSize",e)},setCurrentPath:function(t,e){t.currentPath=e},setCurrentProcess:function(t,e){t.currentProcess=e},setCurrentHref:function(t,e){t.currentHref=e},setCurrentNavigation:function(t,e){t.currentNavigation=e},setTitleAndMenuShow:function(t,e){t.isTitleAndMenuShow=e},setSettingShow:function(t,e){t.isSettingShow=e},setContentShow:function(t,e){t.isContentShow=e},setBookAvailable:function(t,e){t.isBookAvailable=e}},P=new _.a.Store({state:{currentThemeId:0,currentFontSize:16,currentPath:"",currentProcess:0,currentHref:"",currentNavigation:{},isTitleAndMenuShow:!1,isSettingShow:!1,isContentShow:!1,isBookAvailable:!1},mutations:$}),z=s("Fn0J"),A=s.n(z);s("tvR6"),s("jYjM"),s("G1q7");o.default.config.productionTip=!1,o.default.use(i.a),o.default.use(A.a),new o.default({el:"#app",router:T,store:P,components:{App:a},template:"<App/>",render:function(t){return t(a)}})},jYjM:function(t,e){},"l/L2":function(t,e){},m4Hp:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.ccb51c380312b3f673ad.js.map